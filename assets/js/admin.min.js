!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(){"use strict";var b=a("./Wizard.js");m.module(document.getElementById("wizard"),b)}();b.exports=d},{"./Wizard.js":3}],2:[function(a,b,c){var d=function(){var a=this;this.items=m.prop([]),this.addLine=function(b){var c={time:new Date,text:b};a.items().push(c),m.redraw()},this.addTextToLastLine=function(b){var c=a.items().pop();c.text+=" "+b,a.items().push(c),m.redraw()},this.scrollToBottom=function(a,b,c){a.scrollTop=a.scrollHeight},this.render=function(){return m("div.log",{config:a.scrollToBottom},[a.items().map(function(a){var b=("0"+a.time.getHours()).slice(-2)+":"+("0"+a.time.getMinutes()).slice(-2)+":"+("0"+a.time.getSeconds()).slice(-2);return m("p",[m("span.time",b),m.trust(a.text)])})])}};b.exports=d},{}],3:[function(a,b,c){var d=a("./Log.js"),e={};e.askToStart=function(){var a=confirm("Are you sure you want to start synchronising all of your users? This can take a while if you have many users, please don't close your browser window.");a&&e.start()},e.start=function(){e.vm.isRunning(!0);var a={action:"mcs_wizard",mcs_action:"get_users"};e.vm.log.addLine("Fetching users.."),m.request({method:"GET",url:ajaxurl,data:a,type:User}).then(function(a){e.vm.log.addLine("Fetched "+a.length+" users."),e.vm.users(a),e.vm.userCount(a.length),e.subscribeNextUser()},function(a){e.vm.log.addLine("Error fetching users. Error: "+a)})},e.subscribeNextUser=function(){var a=e.vm.users(),b=0;if(0==a.length)return!1;var c=a.shift();e.vm.log.addLine("Synchronising <strong>user #"+c.id()+" "+c.username()+"</strong> (Email: <strong>"+c.email()+"</strong>).");var d={action:"mcs_wizard",mcs_action:"subscribe_users",user_ids:[c.id()]};m.request({method:"GET",data:d,url:ajaxurl}).then(function(a){e.vm.log.addTextToLastLine(a.success?"Success!":"Error."),e.updateProgress(),window.clearTimeout(b),e.subscribeNextUser()},function(a){e.vm.log.addLine("Error: "+a)}),b=setTimeout(e.subscribeNextUser,500)},e.updateProgress=function(){var a=Math.round((e.vm.userCount()-e.vm.users().length)/e.vm.userCount()*100);e.vm.progress(a),100===a&&e.vm.log.addLine("Done!")},e.vm=function(){var a={};return a.init=function(){a.isRunning=m.prop(!1),a.users=m.prop([]),a.userCount=m.prop(0),a.progress=m.prop(0),a.log=new d},a}(),e.controller=function(){e.vm.init()},e.view=function(a){var b=e.vm;return b.isRunning()?[m("div.progress-bar",[m("div.value",{style:"width: "+e.vm.progress()+"%"}),m("div.text",{},100==b.progress()?"Done!":"Working: "+e.vm.progress()+"%")]),e.vm.log.render()]:m("p",[m("input",{type:"submit","class":"button",value:"Synchronise All",onclick:e.askToStart})])},b.exports=e},{"./Log.js":2}]},{},[1]);