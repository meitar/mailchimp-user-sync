!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(){"use strict";var b=a("./Wizard.js");m.module(document.getElementById("wizard"),b)}();b.exports=d},{"./Wizard.js":4}],2:[function(a,b,c){var d=function(){var a=this;this.items=m.prop([]),this.addLine=function(b){var c={time:new Date,text:b};a.items().push(c),m.redraw()},this.addTextToLastLine=function(b){var c=a.items().pop();c.text+=" "+b,a.items().push(c),m.redraw()},this.scrollToBottom=function(a,b,c){a.scrollTop=a.scrollHeight},this.render=function(){return m("div.log",{config:a.scrollToBottom},[a.items().map(function(a){var b=("0"+a.time.getHours()).slice(-2)+":"+("0"+a.time.getMinutes()).slice(-2)+":"+("0"+a.time.getSeconds()).slice(-2);return m("p",[m("span.time",b),m.trust(a.text)])})])}};b.exports=d},{}],3:[function(a,b,c){var d=function(a){this.id=m.prop(a.ID),this.username=m.prop(a.user_login),this.email=m.prop(a.user_email)};b.exports=d},{}],4:[function(a,b,c){var d=a("./Log.js"),e=a("./User.js"),f=function(){function a(){}function b(){var a=confirm("Are you sure you want to start synchronising all of your users? This can take a while if you have many users, please don't close your browser window.");a&&c()}function c(){k=!0,f().then(g).then(h)}function f(){var a=m.deferred(),b={action:"mcs_wizard",mcs_action:"get_user_count"};return m.request({method:"GET",url:ajaxurl,data:b}).then(function(b){q.addLine("Found "+b+" users."),n=b,a.resolve()}),a.promise}function g(){var a=m.deferred();return m.request({method:"GET",url:ajaxurl,data:{action:"mcs_wizard",mcs_action:"get_users",offset:o},type:e}).then(function(b){q.addLine("Fetched "+b.length+" users."),r(b),a.resolve(),m.render()},function(a){q.addLine("Error fetching users. Error: "+a)}),a.promise}function h(){if(!k||l)return!1;if(0===r().length)return o>=n?!1:(g().then(h),!1);var a=r().shift();q.addLine("Synchronising <strong>user #"+a.id()+" "+a.username()+"</strong> (Email: <strong>"+a.email()+"</strong>).");var b={action:"mcs_wizard",mcs_action:"subscribe_users",user_ids:[a.id()]};m.request({method:"GET",data:b,url:ajaxurl}).then(function(a){q.addTextToLastLine(a.success?"Success!":"Error."),o++,i()},function(a){q.addLine("Error: "+a)}).then(h,h)}function i(){var a=Math.round(o/n*100);p(a),a>=100&&(l=!0,q.addLine("Done!"))}function j(){return k?[m("div.progress-bar",[m("div.value",{style:"width: "+p()+"%"}),m("div.text",{},100==p()?"Done!":"Working: "+p()+"%")]),q.render()]:m("p",[m("input",{type:"submit","class":"button",value:"Synchronise All",onclick:b})])}var k=!1,l=!1,n=0,o=0,p=m.prop(0),q=new d,r=m.prop([]);return a(),{controller:a,view:j}}();b.exports=f},{"./Log.js":2,"./User.js":3}]},{},[1]);